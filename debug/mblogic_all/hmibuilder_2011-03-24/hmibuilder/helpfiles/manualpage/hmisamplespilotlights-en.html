<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" 
	"http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >

	<title>Help - HMI - HMI Pilot Light</title>
<link rel="icon" type="image/png" href="/systemicon.png">
<!-- General page layout style sheet. -->
<link rel="stylesheet" href="/helppagelayout.css" type="text/css">
</head>

<body>
<div id="filler">

	<div id="header">
		<p class="headlogo">
			<img src="/systemlogo.png" width="200" alt="MB Logic Logo"/>
			<span class="headtitle1">MBLogic </span>
			<span class="headtitle2"> for an open world in automation</span>
		</p>
	</div>



	<!-- This is the standard nav bar. -->
	<div id="nav">
		<ul>
			<li><a href="/index.html">Home</a></li>
			<li><a href="/svgedit/svgedit.html">Edit SVG</a></li>
			<li><a href="/svglib/svglib.html">SVG Library</a></li>
			<li><a href="/svglibedit/svglibedit.html">Inkscape</a></li>
			<li><a href="/hmitemplates/hmitemplates.html">Templates</a></li>
			<li><a href="/hmibuilder/hmibuilder.html">Assemble Page</a></li>
		</ul>
	</div>


<hr>

	<!-- This is the help system nav bar. -->
	<div id="helpnav">
		<h2>Help Topics</h2>
		<ul>
			<li><a href="/index.html">Home</a></li>
			<li><a href="/svgedit/svgedit.html">Editing SVG with Inkscape</a></li>
			<li><a href="/svglib/svglib.html">SVG Library</a></li>
			<li><a href="/svglibedit/svglibedit.html">Using the SVG Library with Inkscape</a></li>
			<li><a href="/customwidgets/customwidgets.html">Custom Widgets</a></li>
			<li><a href="/hmitemplates/hmitemplates.html">HMI web templates</a></li>
			<li><a href="/hmibuilder/hmibuilder.html">Assembling web pages</a></li>
			<li><a href="/hmilib/hmilib.html">HMI Javascript Client Libraries</a></li>
			<li><a href="/basicconcepts/basicconcepts.html">Basic Concepts</a></li>
			<li><a href="/manualpage/manualpage.html">Manual HMI Web Page Construction</a></li>
		</ul>

		<h3>Manual HMI Web Page Construction</h3>
		<ul>
			<li><a href="/manualpage/hmisampleslayout-en.html">Page Layout</a></li>
			<li><a href="/manualpage/hmisamplespositioning-en.html">
				Positioning Components on the Screen</a></li>
			<li><a href="/manualpage/hmisamplescomms-en.html">
				Communications, the Display List and Data Sources</a></li>
			<li><a href="/manualpage/hmisamplesmenus-en.html">Menu Control</a></li>
			<li><a href="/manualpage/hmisamplesalarms-en.html">
				Events, Alarms, and System Status</a></li>
			<li><a href="/manualpage/hmisamplesxul-en.html">
				Mixing HTML and XUL with SVG</a></li>
			<li><a href="/manualpage/hmisamplespushbuttons-en.html">Push Buttons</a></li>
			<li><a href="/manualpage/hmisamplespilotlights-en.html">Pilot Lights</a></li>
			<li><a href="/manualpage/hmisamplesnumerictext-en.html">
				Numeric and Text Displays</a></li>
			<li><a href="/manualpage/hmisamplesgauges-en.html">Tanks and Gauges</a></li>
			<li><a href="/manualpage/hmisamplespipes-en.html">Piping and Pumps</a></li>
			<li><a href="/manualpage/hmisamplesnumbinput-en.html">Numeric Inputs</a></li>
			<li><a href="/manualpage/hmisamplesstripchart-en.html">Strip Charts</a></li>
			<li><a href="/manualpage/hmisamplesbackground-en.html">Background Images</a></li>
		 	<li><a href="/manualpage/hmisamplesvisualeffects-en.html">Visual Effects</a></li>
		</ul>

	</div>



	<!-- Put main content here -->
	<div id="datadisplay">

<h1>Help - HMI Pilot Light</h1>

<hr>

<h2>Overview:</h2>

<p>
<img src="pl1.png" width="100" height="100" alt="Pilot light">
<img src="pl2.png" width="100" height="100" alt="Pilot light">
<img src="pl3.png" width="100" height="100" alt="Pilot light">
</p>

<p>Pilot lights display information by changing colour when the data they
are associated with changes. They may be simple two colour pilot lights
to represent on/off conditions, or they may have multiple colours to
represent different integer values. 
</p>

<p>A "pilot light" can be more that a simple geometric shape. It can be
any graphic element whose "fill" property can be manipulated. This includes
drawings or schematic representations of equipment, 
</p>

<hr>

<h2>SVG Graphics Library</h2>

<h3>Common Definitions</h3>

<p>Pilot lights make use of a decorative "nut", which in turn makes use of a
silver colour gradient and a drop shadow filter.
</p>

<pre class="examples">

	&lt;!-- These are some definitions which are used below. --&gt;
	&lt;defs&gt;
		&lt;linearGradient id="MB_SilverGradient" 
				x1="1" y1="1" x2="0" y2="0"&gt;
			&lt;stop offset="50%" stop-color="silver" /&gt;
			&lt;stop offset="100%" stop-color="white" /&gt;
		&lt;/linearGradient&gt;

		&lt;!-- The following filter is used to add a drop shadown. --&gt;
		&lt;filter id="MB_DropShadowFilter"&gt;
			&lt;feGaussianBlur stdDeviation="2"&gt;
			&lt;/feGaussianBlur&gt;
		&lt;/filter&gt;

	&lt;/defs&gt;

</pre>

<pre class="examples">

	&lt;defs&gt;
		&lt;!-- This is a decorative octagonal nut. --&gt;
		&lt;g id="MB_NUT"&gt;
			&lt;polygon transform="translate(5,5)" fill="grey" stroke="none"
				filter="url(#MB_DropShadowFilter)"
				points="18,-45 -18,-45 -45,-18 -45,18 -18,45 18,45 45,18 45,-18 18,-45" /&gt;
			&lt;polygon  fill="url(#MB_SilverGradient)" stroke="none"
				points="18,-45 -18,-45 -45,-18 -45,18 -18,45 18,45 45,18 45,-18 18,-45" /&gt;
		&lt;/g&gt;
	&lt;/defs&gt;

</pre>


<h3>Round Pilot Lights</h3>

<p><img src="pl1.png" width="100" height="100" alt="Pilot light">
</p>

<p>A round pilot light is a simple circle.
</p>

<pre class="examples">

	&lt;defs&gt;
		&lt;!-- Circular pilot light. r = 35 px--&gt;
		&lt;g id="MB_PilotLightRound"&gt;
			&lt;!-- This is a decorative nut. --&gt;
			&lt;use xlink:href="#MB_NUT"/&gt;
			&lt;!-- This is the part which changes colour. --&gt;
			&lt;circle cx="0px" cy="0px" r="35px" stroke="black" stroke-width="5px"/&gt;
		&lt;/g&gt;
	&lt;/defs&gt;

</pre>


<h3>Square Pilot Lights</h3>

<p><img src="pl2.png" width="100" height="100" alt="Pilot light">
</p>

<p>A square pilot light is a simple rectangle with rounded corners.
</p>

<pre class="examples">

	&lt;defs&gt;
		&lt;!-- Rectangular pilot light with rounded corners. 60 x 60 px --&gt;
		&lt;g id="MB_PilotLightSquare"&gt;
			&lt;!-- This is a decorative nut. --&gt;
			&lt;use xlink:href="#MB_NUT"/&gt;
			&lt;!-- This is the part which changes colour. --&gt;
			&lt;rect x="-30" y="-30" width="60" height="60" rx="15"
				stroke="black" stroke-width="5px" /&gt;
		&lt;/g&gt;
	&lt;/defs&gt;

</pre>


<h3>Octagonal Pilot Lights</h3>

<p><img src="pl3.png" width="100" height="100" alt="Pilot light">
</p>

<p>An octagonal pilot light is a simple polygon.
</p>

<pre class="examples">

	&lt;defs&gt;
		&lt;!-- Octagonal pilot light. --&gt;
		&lt;g id="MB_PilotLightOctagonal"&gt;
			&lt;!-- This is a decorative nut. --&gt;
			&lt;use xlink:href="#MB_NUT"/&gt;
			&lt;!-- This is the part which changes colour. --&gt;
			&lt;polygon stroke="black" stroke-width="5px" 
			points="13,-35 -13,-35 -35,-13 -35,13 -13,35 13,35 35,13 35,-13 13,-35" /&gt;
		&lt;/g&gt;

	&lt;/defs&gt;

</pre>

<h3>Arbitrary Shapes</h3>

<p>As well as the above pre-defined graphics, a pilot light may be made from 
any arbitrary graphic whose "fill" (colour) property can be manipulated. This
includes custom graphics created for a particular application.
</p>

<hr>

<h2>Creating Pilot Lights</h2>

<p>To turn the graphics into active pilot lights, the graphics must be 
combined with some Javascript scripting, and possibly some text labels. 
</p>

<p>Each pilot light will have the following components:
</p>

<ul>
	<li>A locating transform. This is a statement used to position the pilot 
		light in the desired location. For example: transform="translate(100,0)" 
		will move the pilot light to X=100 and Y=0. Note that transformations 
		may be nested.
	</li>
	<li>A unique "id" label which allows the pilot light to be addressed by
		one of the Javascript pilot light library functions. 
		E.g. &lt;g id="PL1"&gt;
	</li>
	<li>Either a reference to the library, or a user created graphic made from 
	basic SVG elements. For example: &lt;use xlink:href="#MB_PilotLightRound" /&gt;
	</li>
	<li>A Javascript code object which uses the "id" to address and update the
		"fill" property from the display list (or from user created custom code). 
		This is normally located in the main Javscript section at the end of the
		web page. 
	</li>
</ul>

<hr>

<h2>Simple Pilot Lights:</h2>

<h3>SVG</h3>

<p>The following creates the graphics for four pilot lights called "PL1", 
"PL2", "PL3", and "ServerStat". These are a standard round, square, and 
octagonal pilot lights respectively, plus a custom pilot light made from 
a basic SVG element (a rectangle in this case).  
</p>

<pre class="examples">

	&lt;g transform="translate(835,110)"&gt;
		&lt;!-- The first pilot light is a circle. --&gt;
		&lt;g id="PL1"&gt;
			&lt;use xlink:href="#MB_PilotLightRound" /&gt;
		&lt;/g&gt;
	&lt;/g&gt;

	&lt;g transform="translate(835,210)"&gt;
		&lt;!-- This shows a rectangular pilot light with rounded corners. --&gt;
		&lt;g id="PL2"&gt;
			&lt;use xlink:href="#MB_PilotLightSquare" /&gt;
		&lt;/g&gt;
	&lt;/g&gt;

	&lt;g transform="translate(835,310)"&gt;
		&lt;!-- This shows a octagonal pilot light. --&gt;
		&lt;g id="PL3"&gt;
			&lt;use xlink:href="#MB_PilotLightOctagonal" /&gt;
		&lt;/g&gt;
	&lt;/g&gt;


	&lt;!-- This is the server status light. --&gt;
	&lt;g transform="translate(25,10)"&gt;
		&lt;rect id="ServerStat" x="0" y="0" width="200" height="40" rx="15"
			fill="black" stroke="black" stroke-width="5px" /&gt;
		&lt;text x="10" y="30" font-size="24"&gt;Comm Status:&lt;/text&gt; 
	&lt;/g>

</pre>


<h3>Javascript</h3>

<p>The following Javacript code would be located in the main Javascript section
at the end of the web page. We create a new Javascript code object for each
pilot light and add it to the "display list" to allow it to be automatically
updated during each communications scan cycle. 
</p>

<pre class="examples">

	// This defines a pilot light control.
	var PL1 = new MB_PilotLight(document, "PL1", "black", "green", "red");
	var PL2 = new MB_PilotLight(document, "PL2", "black", "green", "red");
	var PL3 = new MB_PilotLight(document, "PL3", "black", "blue", "yellow");

	// Now, add each of these screen objects to the list of things to update.
	MBHMIProtocol.AddToDisplayList(PL1, "PL1", "read");
	MBHMIProtocol.AddToDisplayList(PL2, "PL2", "read");
	MBHMIProtocol.AddToDisplayList(PL3, "PL3", "read");

	// This is for the server status display on the main screen.
	var ServerStat = new MB_PilotLightStat(document, "ServerStat", "black",
		"green", "red", "ok");
	MBHMIProtocol.AddToDisplayList(ServerStat, "stat", "stat");

</pre>


<h3>Javascript Library Functions:</h3>

<p>The following Javascript library functions are useful for this feature:
</p>

<ul>
	<li>MB_PilotLight</li>
</ul>


<h3>How it works:</h3>

<p>The above example shows how to create pilot lights using the standard 
simple SVG library or by using simple geometric shapes. There is a circle 
(PL1), a square (PL2), a octagon (PL3), and an elongated rectangle with a 
text label (ServerStat). 
</p>

<p>Each pilot light must have a Javascript object created to control it. The
MB_PilotLight object needs an "id" reference to the SVG graphic (e.g. id="PL1"),
and three colours. The first colour is the default which is used when the
object is initialised. If the system fails to start due to an error (e.g. a 
programming error), this default value will be displayed instead of the
normal ones. The other two colours are the ones which are displayed to
represent a 0 (false) or 1 (true) state.  
</p>

<p>Each pilot light object must then be added to the display list by calling
MBHMIProtocol.AddToDisplayList. AddToDisplayList must be given the pilot light
object, the tag name, and the source of the data. If the source of the data
is a normal read from the server, the last parameter is "read". If the source
is some other protocol item, then that name is used. In this case, "stat" is
used for the ServerStat pilot light in order to read the communications status.
</p>

<p>In this example, the pilot light "id" names for the first three pilot lights
were made to be the same as the protocol tag names. This is not necessary, but 
was convenient in this case. The fourth pilot light (ServerStat) used a different
name for the SVG "id" name than for the protocol tag.
</p>

<hr>

<h2>Multi-Colour Pilot Lights:</h2>

<p><img src="pl1.png" width="100" height="100" alt="Pilot light">
</p>

<p>A multi-colour pilot light will assume a variety of colours corresponding
to an integer value. The colours are specified by creating an array of colour
names and using the monitored value as an index to the array. The actual SVG
elements are the same as for ordinary two colour pilot lights. The only 
difference is that a different Javascript object is used to control it. 
</p>

<h3>SVG</h3>

<pre class="examples">

	&lt;!-- This is another round pilot light. --&gt;
	&lt;g transform="translate(300,225)"&gt;
		&lt;g id="PL4"&gt;
			&lt;use xlink:href="#MB_PilotLightRound" /&gt;
		&lt;/g&gt;
	&lt;/g&gt;

</pre>

<h3>Javascript</h3>


<pre class="examples">

	// Create the list of colours.
	var ColourList = ["red", "orange", "yellow", "green", "blue", "indigo", "violet"]; 
	// Create the object.
	var PL4 = new MB_PLMultiColour(document, "PL4", "black", ColourList);
	// Add it to the display list.
	MBHMIProtocol.AddToDisplayList(PL4, "PL4", "read");

</pre>


<h3>Javascript Library Functions:</h3>

<p>The following Javascript library functions are useful for this feature:
</p>

<ul>
	<li>MB_PLMultiColour</li>
</ul>


<h3>How it works:</h3>

<p>The multi-colour pilot light is similar to the normal two colour type except
it uses MB_PLMultiColour to create the Javascript object. Instead of specifying
on and off colours, it accepts an array of colours. The first colour in the array
corresponds to integer 0, the second to integer 1, the third to integer 2, etc. 
</p>


<hr>

<h2>Status Pilot Lights:</h2>

<p>A status pilot light differs from a regular pilot light in that it compares
the value of the tag is it monitoring to a reference value. If the monitored 
value matches the reference value, the pilot light turns on. If it does not
match, the pilot light turns off. 
</p>

<h3>SVG</h3>

<pre class="examples">

	&lt;!-- This is the server status light. --&gt;
	&lt;g transform="translate(25,10)"&gt;
		&lt;rect id="ServerStat" x="0" y="0" width="200" height="40" rx="15"
			fill="black" stroke="black" stroke-width="5px" /&gt;
		&lt;text x="10" y="30" font-size="24"&gt;Comm Status:&lt;/text&gt; 
	&lt;/g&gt;

</pre>

<h3>Javascript</h3>


<pre class="examples">

	// This is for the server status display on the main screen.
	var ServerStat = new MB_PilotLightStat(document, "ServerStat", "black",
		"green", "red", "ok");
	MBHMIProtocol.AddToDisplayList(ServerStat, "stat", "stat");

</pre>


<h3>Javascript Library Functions:</h3>

<p>The following Javascript library functions are useful for this feature:
</p>

<ul>
	<li>MB_PilotLightStat</li>
</ul>


<h3>How it works:</h3>

<p>The status pilot light is similar to the other pilot lights, except the
function accepts an additional parameter as the reference parameter ("ok" 
in this example). In this example the pilot light monitors the communications
status ("stat") instead of a normal address tag. This allows it to signal
when a communications error is present. 
</p>


<hr>


<h2>Illuminated Push Buttons:</h2>

<p>Illuminated push buttons are described in the section on push buttons. See
that page for more details.
</p>


<hr>


<h2>Controlling Pilot Lights Directly:</h2>

<p>Pilot lights would normally be controlled through the display list. However, 
it is also possible to control them directly via custom Javascript. 
</p>

<h3>SVG</h3>

<pre class="examples">

	&lt;!-- This is the server status light. --&gt;
	&lt;g transform="translate(25,60)"&gt;
		&lt;rect id="CommWatchDog" x="0" y="0" width="200" height="40" rx="15"
			fill="black" stroke="black" stroke-width="5px" /&gt;
		&lt;text x="10" y="30" font-size="20"&gt;Comm Watchdog:&lt;/text&gt; 
	&lt;/g&gt;

</pre>

<h3>Javascript</h3>


<pre class="examples">

	// This is for the communications watch dog display. We *don't* add
	// this to the display list. Rather, we manipulate it directly.	
	var CommWD = new MB_PilotLight(document, "CommWatchDog", "black", "green", "red");

</pre>

<p>The following code is called regularly as part of the normal scan cycle.</p>

<pre class="examples">

	// Check the comms watch dog counters.
		ComsTimeOut = MBHMIProtocol.CommsWatchDogTimeOut(10);
		if (ComsTimeOut) {
			CommWD.UpdateScreen(1);
		} else {
			CommWD.UpdateScreen(0);
		}

</pre>


<h3>Javascript Library Functions:</h3>

<p>The following Javascript library functions are useful for this feature:
</p>

<ul>
	<li>MB_PilotLight</li>
	<li>MB_PLMultiColour</li>
	<li>MB_PilotLightStat</li>
</ul>


<h3>How it works:</h3>

<p>The display list controls pilot lights by calling their "UpdateScreen" 
method with a data value as a parameter. In this example, the pilot light
object is called directly (e.g. "CommWD.UpdateScreen(1)") with 0 or 1 as a 
parameter. This permits simple control in applications where the normal
display list does not offer the functionality desired. 
</p>


<hr>


</div>


<!-- Standard footer -->
<div id="footer">
	<p>Help - HMI Pilot Light</p>
</div>

</div>

</body>
</html>

<!-- Copyright 2009. Michael Griffin
This file is part of MBLogic.
MBLogic is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
MBLogic is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with MBLogic. If not, see <http://www.gnu.org/licenses/>.
 -->

