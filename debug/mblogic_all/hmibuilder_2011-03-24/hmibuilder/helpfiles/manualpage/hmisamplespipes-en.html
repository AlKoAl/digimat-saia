<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" 
	"http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >

	<title>Help - HMI - HMI Pipes and Pumps</title>
<link rel="icon" type="image/png" href="/systemicon.png">
<!-- General page layout style sheet. -->
<link rel="stylesheet" href="/helppagelayout.css" type="text/css">
</head>

<body>
<div id="filler">

	<div id="header">
		<p class="headlogo">
			<img src="/systemlogo.png" width="200" alt="MB Logic Logo"/>
			<span class="headtitle1">MBLogic </span>
			<span class="headtitle2"> for an open world in automation</span>
		</p>
	</div>



	<!-- This is the standard nav bar. -->
	<div id="nav">
		<ul>
			<li><a href="/index.html">Home</a></li>
			<li><a href="/svgedit/svgedit.html">Edit SVG</a></li>
			<li><a href="/svglib/svglib.html">SVG Library</a></li>
			<li><a href="/svglibedit/svglibedit.html">Inkscape</a></li>
			<li><a href="/hmitemplates/hmitemplates.html">Templates</a></li>
			<li><a href="/hmibuilder/hmibuilder.html">Assemble Page</a></li>
		</ul>
	</div>


<hr>

	<!-- This is the help system nav bar. -->
	<div id="helpnav">
		<h2>Help Topics</h2>
		<ul>
			<li><a href="/index.html">Home</a></li>
			<li><a href="/svgedit/svgedit.html">Editing SVG with Inkscape</a></li>
			<li><a href="/svglib/svglib.html">SVG Library</a></li>
			<li><a href="/svglibedit/svglibedit.html">Using the SVG Library with Inkscape</a></li>
			<li><a href="/customwidgets/customwidgets.html">Custom Widgets</a></li>
			<li><a href="/hmitemplates/hmitemplates.html">HMI web templates</a></li>
			<li><a href="/hmibuilder/hmibuilder.html">Assembling web pages</a></li>
			<li><a href="/hmilib/hmilib.html">HMI Javascript Client Libraries</a></li>
			<li><a href="/basicconcepts/basicconcepts.html">Basic Concepts</a></li>
			<li><a href="/manualpage/manualpage.html">Manual HMI Web Page Construction</a></li>
		</ul>

		<h3>Manual HMI Web Page Construction</h3>
		<ul>
			<li><a href="/manualpage/hmisampleslayout-en.html">Page Layout</a></li>
			<li><a href="/manualpage/hmisamplespositioning-en.html">
				Positioning Components on the Screen</a></li>
			<li><a href="/manualpage/hmisamplescomms-en.html">
				Communications, the Display List and Data Sources</a></li>
			<li><a href="/manualpage/hmisamplesmenus-en.html">Menu Control</a></li>
			<li><a href="/manualpage/hmisamplesalarms-en.html">
				Events, Alarms, and System Status</a></li>
			<li><a href="/manualpage/hmisamplesxul-en.html">
				Mixing HTML and XUL with SVG</a></li>
			<li><a href="/manualpage/hmisamplespushbuttons-en.html">Push Buttons</a></li>
			<li><a href="/manualpage/hmisamplespilotlights-en.html">Pilot Lights</a></li>
			<li><a href="/manualpage/hmisamplesnumerictext-en.html">
				Numeric and Text Displays</a></li>
			<li><a href="/manualpage/hmisamplesgauges-en.html">Tanks and Gauges</a></li>
			<li><a href="/manualpage/hmisamplespipes-en.html">Piping and Pumps</a></li>
			<li><a href="/manualpage/hmisamplesnumbinput-en.html">Numeric Inputs</a></li>
			<li><a href="/manualpage/hmisamplesstripchart-en.html">Strip Charts</a></li>
			<li><a href="/manualpage/hmisamplesbackground-en.html">Background Images</a></li>
		 	<li><a href="/manualpage/hmisamplesvisualeffects-en.html">Visual Effects</a></li>
		</ul>

	</div>



	<!-- Put main content here -->
	<div id="datadisplay">

<h1>Help - HMI Pipes and Pumps</h1>

<hr>

<h2>Overview:</h2>

<p>Pipes and pumps can be used to provide a graphical indication of the function
of a process system. The possibilities include more than just pipes and pumps.
Any continuous flow or motion can be indicated, including gases, conveyors, 
feeders, and other devices.
</p>


<hr>

<h2>Pumps and Fans:</h2>
<p>
<img src="pump.png" width="124" height="110" alt="Pump">
</p>


<p>A "pump" (or fan) is a graphical element that is animated continuously by
rotating a an SVG element. The pump can monitor an integer value which determines
the direction of rotation. Any graphical element capable of being rotated can
be used as a "pump". 
</p>

<h3>SVG</h3>

<p>The pump consists of a decorative background ("MB_PumpFrame") and rotating 
centre ("MB_PumpRotor"). The background can be any colour or gradient. The rotor
can be any colour in combination with yellow.  
</p>

<pre class="examples">

	&lt;!-- This is a rotating pump. --&gt;
	&lt;defs&gt;
		&lt;!-- The outer case of the pump. --&gt;
		&lt;g id="MB_PumpFrame"&gt;
			&lt;polygon points="-25,0 -40,40 40,40 25,0" /&gt;
			&lt;circle cx="0" cy="0" r="25" fill="yellow"/&gt;
			&lt;circle cx="0" cy="0" r="25" fill="none" stroke-width="10" /&gt;
		&lt;/g&gt;
	
		&lt;!-- This is the rotor for the pump. --&gt;
		&lt;g id="MB_PumpRotor"&gt;
			&lt;polygon points="-22,0 22,0 15,-15 0,-22 0,22 -15,15 -22,0" /&gt;
		&lt;/g&gt;
	
	&lt;/defs&gt;

</pre>

<p>This shows how to use the pump. 
</p>

<pre class="examples">

	&lt;g transform="translate(162,50)"&gt;
		&lt;!-- This is the body of the pump. --&gt;
		&lt;!-- &lt;g fill="purple"&gt; --&gt;
		&lt;g  fill="url(#MB_IndigoGradient)" stroke="url(#MB_IndigoGradient)"&gt;
			&lt;use xlink:href="#MB_PumpFrame"/&gt;
		&lt;/g&gt;
		&lt;!-- This is the pump rotor. --&gt;
		&lt;g id="Pump1" fill="red"&gt;
			&lt;use xlink:href="#MB_PumpRotor" /&gt;
		&lt;/g&gt;
	&lt;/g&gt;

</pre>


<h3>Javascript</h3>

<pre class="examples">

	// Pump rotation.
	var PumpRotation = new MB_PumpRotate(document, "Pump1", 19);
	MBHMIProtocol.AddToDisplayList(PumpRotation, "PumpSpeedActual", "read");

</pre>


<h3>Javascript Library Functions:</h3>

<p>The following Javascript library functions are useful for this feature:
</p>

<ul>
	<li>MB_PumpRotate</li>
</ul>


<h3>How it works:</h3>

<p>The pump works by monitoring an integer value. The pump object is initialised
with a reference to the SVG element, and with a rotation increment (in degrees). 
If the monitored value is zero, the pump is stationary. If the monitored value 
is positive, the rotation increment is added to the existing angle. If the value
is negative, the rotation increment is subtracted from the existing angle. A
larger rotation increment will give the appearance of a faster rotation speed. 
The rotation increment may be positive or negative. Using a negative increment
will cause reverse rotation relative to the monitored value.  
</p>

<hr>


<h2>Animated Pipes, Ducts, and Conveyors Using Gradients:</h2>

<p>Animated pipes give the appearance of motion by moving a colour gradient
along a line or rectangle. This can be used to indicate motion in pipes, ducts, 
conveyors, and other similar devices. These can be any shape or size.
</p>

<h3>SVG</h3>

<p>
<img src="hmipipeflowrec.png" width="320" height="150" alt="Pipe">
</p>

<p>Pipes may be constructed using rectangles. These are animated by manipulating
the "fill" property via a linear gradient. Adjusting the "x" and "y" parameters 
will change the direction of flow, as well as the separation between colour 
bands. The colours are changed by changing the "stop-colour" parameters. 
Multiple pipes can share the same gradient, and so be animated together. The 
'spreadMethod="repeat"' parameters is what cases the colour gradient to be 
repeated.
</p>

<pre class="examples">

	&lt;!-- This displays the flow in the piping. The X and
			Y parameters control the direction the gradient moves in.--&gt;
	&lt;linearGradient id="PipeFlowV" spreadMethod="repeat" 
			x1="0%" x2="0%" y1="0%" y2="50%"&gt;
		&lt;stop id="PipeFlowVA" offset="10%" stop-color="white" /&gt;
		&lt;stop id="PipeFlowVB" offset="20%" stop-color="blue" /&gt;
	&lt;/linearGradient&gt;

	&lt;linearGradient id="PipeFlowH" spreadMethod="repeat" 
			x1="0%" x2="40%" y1="0%" y2="0%"&gt;
		&lt;stop id="PipeFlowHA" offset="10%" stop-color="white" /&gt;
		&lt;stop id="PipeFlowHB" offset="20%" stop-color="blue" /&gt;
	&lt;/linearGradient&gt;


	&lt;g transform="translate(120,225)"&gt;
		&lt;!-- Vertical pipe from tank 1 to first bend. --&gt;
		&lt;rect x="0" y="0" width="10" height="50" fill="url(#PipeFlowV)" /&gt;
		&lt;!-- Horizontal pipe from bend below tank 1 to pump. --&gt;
		&lt;rect x="0" y="50" width="140" height="10" fill="url(#PipeFlowH)" /&gt;
	&lt;/g&gt;

</pre>


<h3>Javascript</h3>

<p>Each gradient must be animated separately. This example is using separate
gradients for vertical and horizontal flow to allow the appearance of the flow
to travel along the pipe in each case. 
</p>

<pre class="examples">

	// Pipe flow for vertical pipes.
	var PipeFlowV = new MB_PipeFlow2(document, "PipeFlowVA", "PipeFlowVB", 20);
	MBHMIProtocol.AddToDisplayList(PipeFlowV, "PumpSpeedActual", "read");

	// Pipe flow for horizontal pipes.
	var PipeFlowH = new MB_PipeFlow2(document, "PipeFlowHA", "PipeFlowHB", 20);
	MBHMIProtocol.AddToDisplayList(PipeFlowH, "PumpSpeedActual", "read");

</pre>


<h3>Javascript Library Functions:</h3>

<p>The following Javascript library functions are useful for this feature:
</p>

<ul>
	<li>MB_PipeFlow2</li>
</ul>

<p><strong><em>Note:</em></strong> An older version of this function called 
"MB_PipeFlow" is also provided for compatibility reasons. The older version 
required a more complex linear gradient definition. The new version 
"MB_PipeFlow2" should be used in all new applications.
</p>

<h3>How it works:</h3>

<p>The animated pipe uses colour gradients in a manner similar to that of tanks
and column gauges. However, the pipe adds an additional gradient stop and adjusts
the gradient values continuously. This gives the appearance of a bubble of colour
moving along a line. A rectangle, polyline, or other closed shape may be used.
</p>

<p>The animated pipe operates in a manner similar to that of the pump, except
it changes a gradient instead of applying a rotation. It monitors for zero,
negative, and positive values, and uses this to determine whether to add or
subtract a flow increment integer. This means a pipe can monitor the same tag 
as a pump and the animations will be coordinated between them. 
</p>


<hr>


<h2>Pipes, Ducts, and Conveyors Using Colour Change:</h2>

<p>An alternative representation for pipes, ducts, conveyors, etc. is to
change the colour of a rectangle or line. This has less overhead than 
continuous animation and so may be more suitable for very complex graphics 
or very slow client computers. It may also be used in applications where
animation is not desired for style or appearance reasons.
</p>

<h3>SVG for Rectangles</h3>

<p>
<img src="hmipipecolourrec.png" width="280" height="150" alt="Pipe">
</p>

<p>In this example we have grouped several rectangles so we can manipulate them 
together.   
</p>

<pre class="examples">

	&lt;!-- Group these pipes together so we can alter them using only one id. --&gt;
	&lt;g id="Tank2Pipe"&gt;
		&lt;!-- Vertical pipe from tank 2 to first bend. --&gt;
		&lt;rect x="300" y="0" width="10" height="50" /&gt;
		&lt;!-- Horizontal pipe from bend below tank 2 to pump. --&gt;
		&lt;rect x="190" y="50" width="120" height="10" /&gt;
	&lt;/g&gt;

</pre>


<h3>Javascript for Rectangles</h3>

<p>The Javascript for rectangles manipulates the "fill" property.
</p>

<pre class="examples">

	// Pipe flow using pipes which change colour instead of animating.
	// This is different from a pilot light in that any non-zero value
	// is considered to be 'on'.
	var Tank2Pipe = new MB_Pipe2(document, "Tank2Pipe", "black", "green", "red");
	MBHMIProtocol.AddToDisplayList(Tank2Pipe, "PumpSpeedActual", "read");

</pre>


<h3>SVG for Polylines</h3>

<p>
<img src="hmipipecolourline.png" width="120" height="50" alt="Pipe">
</p>

<p>Polylines can also be used.
</p>

<pre class="examples">

	&lt;!-- This pipe simply changes colour. --&gt;
	&lt;polyline id="Dial1Pipe" fill="none" stroke="black" stroke-width="10"
					points="175,255 250,255 250,240" /&gt;

</pre>


<h3>Javascript for Polylines</h3>

<p>The Javascript for polylines manipulates the "stroke" property.
</p>

<pre class="examples">

	// Connect the dial gauge to the tank.
		var Dial1Pipe = new MB_Pipe(document, "Dial1Pipe", "black", "green", "red");
		MBHMIProtocol.AddToDisplayList(Dial1Pipe, "PumpSpeedActual", "read");

</pre>


<h3>Javascript Library Functions:</h3>

<p>The following Javascript library functions are useful for this feature:
</p>

<ul>
	<li>MB_Pipe</li>
	<li>MB_Pipe2</li>
</ul>


<h3>How it works:</h3>

<p>The coloured pipe object monitors a value. If the value is zero, the 
SVG "fill" or "stroke" property is set to the "off" colour. If the value is 
non-zero, the SVG "stroke" property is set to the "on" colour. MB_Pipe and 
MB_Pipe2 differ from a pilot light in that the data for a pilot light must be 
"0" or "1", while a pipe may be "0" for stopped, and any other numeric value 
for flowing ("on"). 
</p>


<hr>


</div>


<!-- Standard footer -->
<div id="footer">
	<p>Help - HMI Pipes and Pumps</p>
</div>

</div>

</body>
</html>

<!-- Copyright 2009. Michael Griffin
This file is part of MBLogic.
MBLogic is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.
MBLogic is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.
You should have received a copy of the GNU General Public License
along with MBLogic. If not, see <http://www.gnu.org/licenses/>.
 -->

